import "hashes/pedersen/512bitBool" as pedersen_hash;
import "utils/pack/bool/unpack256" as unpacker;
import "utils/pack/bool/pack256" as packer;


def main(field secret, field nullifier) -> field {
  bool[256] secret_bits = unpacker(secret);
  bool[256] nullifier_bits = unpacker(nullifier);
  bool[512] pedersen_input = [...secret_bits ,...nullifier_bits];
  bool[256] hash = pedersen_hash(pedersen_input);
  return packer(hash);
}
